<!DOCTYPE html>
<html>

<head>
    <script type="text/javascript" src="static/motpal.js"></script>
    <script type="text/javascript">
        function connect_stream(timeout = 250) {
            console.log("Connecting to stream...");
            var source = new EventSource("/stream");
            source.addEventListener("player_update", function (event) {
                update_player_list(JSON.parse(event.data));
            }, false);
            source.addEventListener("error", async function (event) {
                console.log("Connection lost. Trying again in " + timeout + " ms.");
                await new Promise(r => setTimeout(r, timeout));
                connect_stream(timeout * 2);
            }, false);
        }

        window.onload = function () {
            load_players();
            connect_stream();
        };
    </script>
</head>

<body>
    <h1>Players:</h1>
    <ul id="player_list"></ul>
</body>

</html>